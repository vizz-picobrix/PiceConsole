import{w as t}from"./DGJAQINX.js";const n=t({user:null,isAuthenticated:!1,isLoading:!0});async function l(){try{console.log("Fetching user info from /.auth/me");const e=await fetch("/.auth/me");if(console.log("Response status:",e.status,e.statusText),!e.ok)return console.log("Response not OK, returning null"),null;const i=await e.json();console.log("Auth response data:",i);const o=i.clientPrincipal;if(!o)return console.log("No clientPrincipal found, returning null"),null;const s={userId:o.userId,userDetails:o.userDetails,userRoles:o.userRoles||[],identityProvider:o.identityProvider};return console.log("User info extracted:",s),s}catch(e){return console.error("Failed to fetch user info:",e),null}}async function u(){console.log("Initializing auth..."),n.update(e=>({...e,isLoading:!0}));try{const e=await l();console.log("Auth initialization complete:",{user:e,isAuthenticated:!!e}),n.update(i=>({...i,user:e,isAuthenticated:!!e,isLoading:!1}))}catch(e){console.error("Auth initialization failed:",e),n.update(i=>({...i,user:null,isAuthenticated:!1,isLoading:!1}))}}function r(){let e=null,i=null;return n.subscribe(s=>{e=s.user,i=s})(),console.log("isOperator check:",{hasUser:!!e,userRoles:e==null?void 0:e.userRoles,userDetails:e==null?void 0:e.userDetails,isAuthenticated:i==null?void 0:i.isAuthenticated,isLoading:i==null?void 0:i.isLoading}),!!e&&!!(i!=null&&i.isAuthenticated)}function c(){window.location.href="/login"}function d(){window.location.href="/logout"}export{n as a,r as b,d as c,u as i,c as l};
