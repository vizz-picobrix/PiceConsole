import{w as s}from"./BG_EMoNd.js";const n=s({user:null,isAuthenticated:!1,isLoading:!0});async function a(){try{const e=await fetch("/.auth/me");if(!e.ok)return null;const i=(await e.json()).clientPrincipal;return i?{userId:i.userId,userDetails:i.userDetails,userRoles:i.userRoles||[],identityProvider:i.identityProvider}:null}catch(e){return console.error("Failed to fetch user info:",e),null}}async function u(){n.update(e=>({...e,isLoading:!0}));try{const e=await a();n.update(t=>({...t,user:e,isAuthenticated:!!e,isLoading:!1}))}catch(e){console.error("Auth initialization failed:",e),n.update(t=>({...t,user:null,isAuthenticated:!1,isLoading:!1}))}}function l(){let e=null,t=null;return n.subscribe(r=>{e=r.user,t=r})(),!!e&&!!(t!=null&&t.isAuthenticated)}function c(){window.location.href="/login"}function d(){window.location.href="/logout"}export{n as a,d as b,l as c,u as i,c as l};
